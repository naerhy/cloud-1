---
- name: Uninstall Docker Engine
  hosts: ovh
  become: true
  tasks:
    - name: Uninstall packages
      ansible.builtin.apt:
        name:
          - docker-ce
          - docker-ce-cli
          - containerd.io
          - docker-buildx-plugin
          - docker-compose-plugin
          - docker-ce-rootless-extras
        state: absent
        purge: true
    - name: Remove images, containers, volumes, source list and keyrings
      ansible.builtin.file:
        path: "{{ item }}"
        state: absent
      loop:
        - /var/lib/docker
        - /var/lib/containerd
        - /etc/apt/sources.list.d/docker.list
        - /etc/apt/keyrings/docker.asc
...
